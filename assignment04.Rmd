---
title: "Assignment 04"
author: "Hannah Hill & Imani Sherill"
date: "2/23/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(srvyr)
library(janitor)
library(dplyr)
census <- read_csv("poverty1.csv")
census <- census [9:63 , 1:5] %>%
  na.omit() %>%
  rename(category = 1) %>%
  rename(total_pop = 2) %>%
  rename(in_poverty = 3) %>%
  rename(moe = 4) %>%
  rename(percent_poverty = 5)
view(census)
```

```{r, cleaning data}
race <- census [2:6, 1:5] %>%
  rename(race = category)
age <- census [9:11, 1:5] %>%
  rename(age = category)
sex <- census [7:8, 1:5] %>%
  rename(sex = category)
nativity <- census [12:15, 1:5] %>%
  rename(nativity = category)
region <- census [16:19, 1:5] %>%
  rename(region = category)
metro <- census [20:23, 1:5] %>%
  rename(metro = category)
work_status <- census [25:28, 1:5] %>%
  rename(work_status = category)
disability <- census [30:31, 1:5] %>%
  rename(disability = category)
educ <- census [33:36, 1:5] %>%
  rename(educ = category)
```


```{r}
gini <- read_csv("gini.csv")
gini <- gini [4:63, 1:14] %>%
  rename(category = 1)
gini <- gini [4:63, 1:14] %>%
  na.omit() %>%
  rename(year = category) %>%
  rename(mean_lowest_quint = 2) %>%
  rename(mean_second_quint = 3) %>%
  rename(mean_middle_quint = 4) %>%
  rename(mean_fourth_quint = 5) %>%
  rename(mean_highest_quint = 6) %>%
  rename(mean_top5 = 7) %>%
  rename(gini_coefficient = 14)
giniplot <- gini [1:56, 1:7]

inequality <- read_csv("inequality.csv")
#probably don't use inequality just use gini and census
```

## Data Visualization 1
# Race
```{r, visualization 1}
race %>%
  select(race, total_pop, in_poverty, percent_poverty) %>%
  mutate(percent_poverty = as.numeric(percent_poverty)) %>%
  # select(race, percent_poverty) %>%
  ggplot() +
  geom_col(mapping = aes(x = race, y = percent_poverty, fill = race)) +
  theme_minimal() +
  labs(
    title = "Americans Experiencing Poverty in 2019 by Race",
    subtitle = "Data Visualization 01",
    caption = "Source: U.S. Census Bureau",
    x = "Race",
    y = "Percentage in Poverty"
  )
```


## Data Visualization 2
# Sex, Age, Educational Attainment
```{r}

```


## Measuring Income Inequality in the United States, 1976-2020
# Data Visualization 03

The Gini coefficient is a measure of income inequality across different groups. A Gini coefficient closer to 0 represents equal income while a value closer to 1 represents a high degree of inequality. In the graph below, income inequality steadily increases from .38 to to .47 representing a shift in wider dispersion and greater inequality between 1967 and 2020 within the United States.

``` {r}
library(ggplot2)
gini %>%
  mutate(gini_coefficient = as.numeric(gini_coefficient)) %>%
  mutate(year = as.numeric(year)) %>%
  ggplot(mapping = aes(x = year, y = gini_coefficient)) +
  geom_point(color = "blue") +
  geom_smooth(method=lm, color = "red", se=FALSE) +
  ylim(.2,.6) +
  theme_minimal() +
  labs(x = "Year",
       y = "Gini Coefficients") +
  theme_minimal()
```

## The Rich Keep Getting Richer
# Data Visualization 04

In this graph, the mean income for the top 5% of households in the United States is documented across the years 1967 to 2020. For the richest 5%, the mean household income is trending upwards from $180,000 in 1967 to $446,000 in 2020. While these data provide a small insight into how the wealthiest are doing financially the last 50 years, analysis is limited by the fact that the data used are averages and not medians. This graph, however, does illustrate the impact of the 2008 Great Recession had on even the top 5% of households where mean household income drops off sharply after 2007.
```{r}
giniplot %>%
  mutate(.data = giniplot, year = as.numeric(year)) %>%
  #mutate(mean_top5 = as.numeric(mean_top5)) #%>%
  ggplot(aes(x = year, y = mean_top5)) +
  geom_area(fill = "#69b3a2", alpha =0.4) +
  geom_line(color = "69b3a2", size = 2) +
  geom_point(size = 6, color = "#69b3a2") +
  geom_jitter() +
  scale_x_continuous(breaks = c(1975,1990,2005,2020)) +
  #scale_y_continuous(breaks = c(185000,250000, 315000, 380000,445000,510000)) +
  theme_minimal() +
  labs(
    title = "The Rich Keep Getting Richer:",
    subtitle = "The Top 5% of Household's Mean Income",
    x = "Year",
    y = "Mean Annual Income"
  )
```

